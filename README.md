# Agio

Инструментарий для расчета курсовой разницы, образовавшейся вследствии продажи валюты в день, отличный от дня поступления валюты на счет юридического лица. Расчет основан на определенных (см. ниже) выписках из системы "Клиент-Банк" юридических лиц и необходим для правильного заполнения валовой выручки на территории Республики Беларусь.

## Использование

1. Для начала необходимо экспортировать необходимые выписки из системы "Клиент-Банк":
  - №400 для счета в BYR (счет, на который идут поступления после продажи валюты) в файл `payments.txt`;
  - №62 - платежи свободной продажи в файл `free_sales.txt`;
  - №252 - сведения о поступлении платежей в валюте в файл `compulsory_sales.txt`.

1. Переместить файлы в `./bank_files`.
1. Запустить скрипт:

```ruby
require 'agio'

filter = {start_date: Date.parse('2018-01-03'), end_date: Date.parse('2018-03-31')}
Agio::Report.new(filter).generate
```

Вывод производится в текстовом виде в консоль.

## Конфигурация

Скопируйте файл `config.yml` в `config.local.yml`. Измените необходимые настройки.

## Органичения

1. Только для юр. лиц и индивидуальных предпринимателей Республики Беларусь;
1. Протестировано только на МТБанк в системе "Электронные платежи (клиент) v 2.61.45.00";
1. Размер обязательной продажи выставлен как константа и равен 10%;
1. Предполагается, что все поступления валюты в USD.

## Разработка

После клонирования репозитория, установите зависимости с помощью команды `bin/setup`. Для запуска тестов используйте команду `rate test`. Также возможно проверить код в интерактивной среде командой `bin/console`.


## Соучастие

На данный момент использование данных скриптов строго лимитировано и предназначено для использования ограниченным кругом лиц из-за множестка ограничений (см. выше). Так что, любые замечания и предложения по улучшению проекта приветствуются и поощряются. Все пожелания и изменения кода отсылайте посредством GitHub: https://github.com/ka8725/agio.


## Лицензия

Это проект с открытым исходным кодом под лицензией [MIT](http://opensource.org/licenses/MIT).
